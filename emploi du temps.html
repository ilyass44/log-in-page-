<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Emploi du Temps</title>
    <style>
        :root {
            --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-secondary: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --bg-container: white;
            --text-primary: #333;
            --text-secondary: #555;
            --text-light: #495057;
            --border-color: #ddd;
            --cell-hover: #e3f2fd;
            --grid-bg: #e1e5e9;
            --modal-bg: rgba(0,0,0,0.5);
        }

        [data-theme="dark"] {
            --bg-primary: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            --bg-secondary: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            --bg-container: #2c3e50;
            --text-primary: #ecf0f1;
            --text-secondary: #bdc3c7;
            --text-light: #95a5a6;
            --border-color: #34495e;
            --cell-hover: #34495e;
            --grid-bg: #34495e;
            --modal-bg: rgba(0,0,0,0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-container);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: var(--bg-secondary);
            color: white;
            text-align: center;
            padding: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .control-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .schedule-container {
            padding: 30px;
        }

        .schedule-grid {
            display: grid;
            grid-template-columns: 100px repeat(7, 1fr);
            gap: 2px;
            background: var(--grid-bg);
            border-radius: 10px;
            overflow: hidden;
        }

        .time-slot, .day-header, .schedule-cell {
            background: var(--bg-container);
            padding: 15px 10px;
            text-align: center;
            font-weight: 500;
            position: relative;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .day-header {
            background: var(--bg-primary);
            color: white;
            font-weight: bold;
        }

        .time-slot {
            background: var(--grid-bg);
            font-weight: bold;
            color: var(--text-light);
        }

        .schedule-cell {
            min-height: 60px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
        }

        .schedule-cell:hover {
            background: var(--cell-hover);
            transform: scale(1.02);
        }

        .schedule-cell.filled {
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
            animation: popIn 0.3s ease-out;
        }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .schedule-cell.filled:hover {
            filter: brightness(1.1);
        }

        .schedule-cell.merged {
            grid-row: span var(--span-count);
            display: flex;
            align-items: center;
            justify-content: center;
            writing-mode: horizontal-tb;
            text-orientation: mixed;
        }

        .schedule-cell.merged .subject-text {
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            width: 100%;
        }

        .schedule-cell.hidden {
            display: none;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: var(--modal-bg);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--bg-container);
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: modalSlideIn 0.3s ease-out;
            color: var(--text-primary);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal h2 {
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--text-secondary);
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            background: var(--bg-container);
            color: var(--text-primary);
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .color-picker-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .color-option {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
        }

        .color-option:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .color-option.selected {
            border-color: var(--text-primary);
            transform: scale(1.1);
        }

        .color-option::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .color-option.selected::after {
            opacity: 1;
        }

        .btn {
            background: var(--bg-primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .close {
            color: var(--text-light);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
            transition: color 0.3s;
        }

        .close:hover {
            color: var(--text-primary);
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-container);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                margin: 0;
            }
            .controls, .modal {
                display: none !important;
            }
            .schedule-cell {
                break-inside: avoid;
            }
        }

        @media (max-width: 768px) {
            .schedule-grid {
                grid-template-columns: 80px repeat(7, 1fr);
                font-size: 12px;
            }
            
            .time-slot, .day-header, .schedule-cell {
                padding: 8px 5px;
            }

            .controls {
                position: static;
                justify-content: center;
                margin-top: 15px;
            }

            .header h1 {
                font-size: 1.8rem;
            }
        }

        /* Dark mode toggle animation */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            border-radius: 15px;
            background: rgba(255,255,255,0.2);
            cursor: pointer;
            transition: all 0.3s;
        }

        .theme-toggle::after {
            content: 'üåô';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-size: 12px;
        }

        [data-theme="dark"] .theme-toggle::after {
            left: 32px;
            content: '‚òÄÔ∏è';
        }

        /* Notification animations */
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(300px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(300px);
            }
        }

        /* Pulse animation for active cells */
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(102, 126, 234, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(102, 126, 234, 0);
            }
        }

        .schedule-cell.pulse {
            animation: pulse 2s infinite;
        }

        /* Shake animation for errors */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="controls">
                <button class="control-btn" onclick="printSchedule()">üñ®Ô∏è Imprimer</button>
                <button class="control-btn" onclick="clearAllData()">üóëÔ∏è Vider tout</button>
                <div class="theme-toggle" onclick="toggleTheme()"></div>
            </div>
            <h1>üìÖ Mon Emploi du Temps</h1>
            <p>Clique sur une case pour ajouter ou modifier une activit√© - Choisis ta couleur pr√©f√©r√©e !</p>
        </div>
        
        <div class="schedule-container">
            <div class="stats-container" id="statsContainer">
                <!-- Stats will be dynamically generated -->
            </div>
            
            <div class="schedule-grid" id="scheduleGrid">
                <!-- Header row -->
                <div class="time-slot">Heure</div>
                <div class="day-header">Lundi</div>
                <div class="day-header">Mardi</div>
                <div class="day-header">Mercredi</div>
                <div class="day-header">Jeudi</div>
                <div class="day-header">Vendredi</div>
                <div class="day-header">Samedi</div>
                <div class="day-header">Dimanche</div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>‚ú® Modifier le cr√©neau</h2>
            <form id="scheduleForm">
                <div class="form-group">
                    <label>‚è∞ Heure de d√©but:</label>
                    <input type="time" id="startTime" required>
                </div>
                <div class="form-group">
                    <label>‚è∞ Heure de fin:</label>
                    <input type="time" id="endTime" required>
                </div>
                <div class="form-group">
                    <label>üìö Activit√©/Mati√®re:</label>
                    <input type="text" id="subject" placeholder="Ex: Math√©matiques, Jeux vid√©o, Sport..." required>
                </div>
                <div class="form-group">
                    <label>üé® Couleur:</label>
                    <div class="color-picker-container" id="colorPicker">
                        <!-- Color options will be generated dynamically -->
                    </div>
                </div>
                <button type="submit" class="btn">üíæ Sauvegarder</button>
                <button type="button" class="btn btn-danger" onclick="deleteActivity()">üóëÔ∏è Supprimer</button>
                <button type="button" class="btn" onclick="closeModal()">‚ùå Annuler</button>
            </form>
        </div>
    </div>

    <script>
        let schedule = {};
        let currentCell = null;
        let timeSlots = [];
        let selectedColor = '#4caf50';

        const colorOptions = [
            '#4caf50', '#2196f3', '#ff9800', '#e91e63', 
            '#9c27b0', '#00bcd4', '#ff5722', '#795548',
            '#607d8b', '#8bc34a', '#ffc107', '#673ab7'
        ];

        // Generate time slots from 8:00 to 20:00
        for (let hour = 8; hour <= 20; hour++) {
            timeSlots.push(`${hour.toString().padStart(2, '0')}:00`);
        }

        const days = ['lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi', 'samedi', 'dimanche'];

        function initializeSchedule() {
            const grid = document.getElementById('scheduleGrid');
            
            timeSlots.forEach(time => {
                const timeCell = document.createElement('div');
                timeCell.className = 'time-slot';
                timeCell.textContent = time;
                grid.appendChild(timeCell);
                
                days.forEach(day => {
                    const cell = document.createElement('div');
                    cell.className = 'schedule-cell';
                    cell.dataset.day = day;
                    cell.dataset.time = time;
                    cell.addEventListener('click', () => openModal(cell));
                    grid.appendChild(cell);
                });
            });

            initializeColorPicker();
            loadScheduleFromMemory();
            updateStats();
        }

        function initializeColorPicker() {
            const colorPicker = document.getElementById('colorPicker');
            colorPicker.innerHTML = '';
            
            colorOptions.forEach(color => {
                const colorOption = document.createElement('div');
                colorOption.className = 'color-option';
                colorOption.style.background = `linear-gradient(135deg, ${color}, ${adjustBrightness(color, -20)})`;
                colorOption.dataset.color = color;
                colorOption.addEventListener('click', () => selectColor(color, colorOption));
                colorPicker.appendChild(colorOption);
            });

            // Select first color by default
            selectColor(colorOptions[0], colorPicker.children[0]);
        }

        function selectColor(color, element) {
            selectedColor = color;
            document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
        }

        function adjustBrightness(hex, percent) {
            const num = parseInt(hex.replace('#', ''), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) + amt;
            const G = ((num >> 8) & 0x00ff) + amt;
            const B = (num & 0x0000ff) + amt;
            return '#' + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
        }

        function openModal(cell) {
            currentCell = cell;
            const day = cell.dataset.day;
            const time = cell.dataset.time;
            const key = `${day}-${time}`;
            
            const modal = document.getElementById('modal');
            const activity = schedule[key];
            
            if (activity) {
                document.getElementById('startTime').value = activity.startTime;
                document.getElementById('endTime').value = activity.endTime;
                document.getElementById('subject').value = activity.subject;
                selectedColor = activity.color || colorOptions[0];
                
                // Update color picker
                document.querySelectorAll('.color-option').forEach(opt => {
                    opt.classList.remove('selected');
                    if (opt.dataset.color === selectedColor) {
                        opt.classList.add('selected');
                    }
                });
            } else {
                document.getElementById('startTime').value = time;
                document.getElementById('endTime').value = '';
                document.getElementById('subject').value = '';
                selectColor(colorOptions[0], document.querySelector('.color-option'));
            }
            
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            currentCell = null;
        }

        function deleteActivity() {
            if (currentCell) {
                const day = currentCell.dataset.day;
                const time = currentCell.dataset.time;
                const key = `${day}-${time}`;
                
                const activityName = schedule[key]?.subject || 'Activit√©';
                delete schedule[key];
                updateDisplay();
                updateStats();
                saveScheduleToMemory();
                showNotification(`üóëÔ∏è ${activityName} supprim√©(e) !`, 'error');
                closeModal();
            }
        }

        document.getElementById('scheduleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            const subject = document.getElementById('subject').value;
            
            // Validate time range
            if (!validateTimeRange(startTime, endTime)) {
                return;
            }
            
            if (currentCell) {
                const day = currentCell.dataset.day;
                const startHour = parseInt(startTime.split(':')[0]);
                const endHour = parseInt(endTime.split(':')[0]);
                
                // Remove old activities for this time range
                for (let hour = startHour; hour < endHour; hour++) {
                    const timeSlot = `${hour.toString().padStart(2, '0')}:00`;
                    const key = `${day}-${timeSlot}`;
                    delete schedule[key];
                }
                
                // Add new activity for the time range
                for (let hour = startHour; hour < endHour; hour++) {
                    const timeSlot = `${hour.toString().padStart(2, '0')}:00`;
                    const key = `${day}-${timeSlot}`;
                    
                    schedule[key] = {
                        startTime: startTime,
                        endTime: endTime,
                        subject: subject,
                        duration: endHour - startHour,
                        color: selectedColor
                    };
                }
                
                updateDisplay();
                updateStats();
                saveScheduleToMemory();
                
                // Add pulse effect to the updated cells
                const updatedCell = document.querySelector(`[data-day="${day}"][data-time="${startTime.split(':')[0].padStart(2, '0')}:00"]`);
                if (updatedCell) {
                    addPulseEffect(updatedCell);
                }
                
                showNotification(`‚úÖ ${subject} ajout√© avec succ√®s !`, 'success');
                closeModal();
            }
        });

        function updateDisplay() {
            document.querySelectorAll('.schedule-cell').forEach(cell => {
                cell.classList.remove('filled', 'merged', 'hidden');
                cell.innerHTML = '';
                cell.style.cssText = '';
            });

            const processedCells = new Set();

            Object.keys(schedule).forEach(key => {
                if (processedCells.has(key)) return;

                const [day, time] = key.split('-');
                const activity = schedule[key];
                const cell = document.querySelector(`[data-day="${day}"][data-time="${time}"]`);
                
                if (!cell) return;

                const consecutiveCells = [cell];
                let nextHour = parseInt(time.split(':')[0]) + 1;
                
                while (nextHour < 21) {
                    const nextTime = `${nextHour.toString().padStart(2, '0')}:00`;
                    const nextKey = `${day}-${nextTime}`;
                    const nextActivity = schedule[nextKey];
                    
                    if (nextActivity && nextActivity.subject === activity.subject) {
                        const nextCell = document.querySelector(`[data-day="${day}"][data-time="${nextTime}"]`);
                        if (nextCell) {
                            consecutiveCells.push(nextCell);
                            processedCells.add(nextKey);
                        }
                        nextHour++;
                    } else {
                        break;
                    }
                }

                processedCells.add(key);

                const gradient = `linear-gradient(135deg, ${activity.color}, ${adjustBrightness(activity.color, -20)})`;

                if (consecutiveCells.length > 1) {
                    const firstCell = consecutiveCells[0];
                    firstCell.classList.add('filled', 'merged');
                    firstCell.style.setProperty('--span-count', consecutiveCells.length);
                    firstCell.style.background = gradient;
                    firstCell.innerHTML = `
                        <div class="subject-text">${activity.subject}</div>
                        <div style="font-size: 12px; margin-top: 5px;">${activity.startTime} - ${activity.endTime}</div>
                    `;

                    for (let i = 1; i < consecutiveCells.length; i++) {
                        consecutiveCells[i].classList.add('hidden');
                    }
                } else {
                    cell.classList.add('filled');
                    cell.style.background = gradient;
                    cell.innerHTML = `
                        <div style="font-weight: bold; font-size: 12px;">${activity.startTime} - ${activity.endTime}</div>
                        <div style="margin-top: 5px;">${activity.subject}</div>
                    `;
                }
            });
        }

        function updateStats() {
            const stats = calculateStats();
            const statsContainer = document.getElementById('statsContainer');
            
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${stats.totalActivities}</div>
                    <div class="stat-label">üìö Activit√©s totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.totalHours}h</div>
                    <div class="stat-label">‚è±Ô∏è Heures planifi√©es</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.busyDays}</div>
                    <div class="stat-label">üìÖ Jours actifs</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.mostCommonSubject}</div>
                    <div class="stat-label">üèÜ Mati√®re principale</div>
                </div>
            `;
        }

        function calculateStats() {
            const activities = Object.values(schedule);
            const subjects = {};
            const daysWithActivities = new Set();
            let totalHours = 0;

            activities.forEach(activity => {
                subjects[activity.subject] = (subjects[activity.subject] || 0) + 1;
                daysWithActivities.add(activity.startTime + activity.subject);
                totalHours += activity.duration || 1;
            });

            const mostCommonSubject = Object.keys(subjects).reduce((a, b) => 
                subjects[a] > subjects[b] ? a : b, 'Aucune') || 'Aucune';

            return {
                totalActivities: activities.length,
                totalHours,
                busyDays: new Set(activities.map(a => a.startTime.split('-')[0])).size,
                mostCommonSubject: mostCommonSubject.length > 10 ? mostCommonSubject.substring(0, 10) + '...' : mostCommonSubject
            };
        }

        // Syst√®me de sauvegarde automatique
        function saveScheduleToMemory() {
            try {
                localStorage.setItem('scheduleData', JSON.stringify(schedule));
                localStorage.setItem('scheduleTheme', document.documentElement.getAttribute('data-theme') || 'light');
                showNotification('üíæ Emploi du temps sauvegard√© !', 'success');
            } catch (error) {
                console.log('Sauvegarde en m√©moire temporaire');
            }
        }

        function loadScheduleFromMemory() {
            try {
                const saved = localStorage.getItem('scheduleData');
                const savedTheme = localStorage.getItem('scheduleTheme');
                
                if (saved) {
                    schedule = JSON.parse(saved);
                    updateDisplay();
                    showNotification('üìö Emploi du temps charg√© !', 'info');
                }
                
                if (savedTheme) {
                    document.documentElement.setAttribute('data-theme', savedTheme);
                }
            } catch (error) {
                console.log('Pas de donn√©es sauvegard√©es');
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : '#2196f3'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                z-index: 10000;
                animation: slideInRight 0.3s ease;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function clearAllData() {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer toutes les activit√©s ?')) {
                schedule = {};
                updateDisplay();
                updateStats();
                saveScheduleToMemory();
                showNotification('üóëÔ∏è Toutes les activit√©s ont √©t√© supprim√©es !', 'error');
            }
        }

        function printSchedule() {
            showNotification('üñ®Ô∏è Pr√©paration de l\'impression...', 'info');
            setTimeout(() => {
                window.print();
            }, 500);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            saveScheduleToMemory(); // Save theme preference
            showNotification(`${newTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è'} Mode ${newTheme === 'dark' ? 'sombre' : 'clair'} activ√© !`, 'info');
        }

        // Add pulse animation to newly created cells
        function addPulseEffect(cell) {
            cell.classList.add('pulse');
            setTimeout(() => {
                cell.classList.remove('pulse');
            }, 2000);
        }

        // Validate time input
        function validateTimeRange(startTime, endTime) {
            const start = new Date(`2000-01-01T${startTime}`);
            const end = new Date(`2000-01-01T${endTime}`);
            
            if (start >= end) {
                showNotification('‚ö†Ô∏è L\'heure de fin doit √™tre apr√®s l\'heure de d√©but !', 'error');
                document.getElementById('endTime').classList.add('shake');
                setTimeout(() => {
                    document.getElementById('endTime').classList.remove('shake');
                }, 500);
                return false;
            }
            return true;
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeSchedule();
        });
    </script>
</body>
</html>